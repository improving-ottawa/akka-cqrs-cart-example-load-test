cinnamon.prometheus {
  exporters += http-server
}

cinnamon.application = "shopping-cart-service"

cinnamon.prometheus {
  exporters += http-server

  http-server {
    host = "0.0.0.0"
    port = 9001
  }
}

cinnamon.akka {

  ask-pattern.actors {
    "/system/*" {
      report-by = instance
      includes = ["tag:ShoppingCart"]
    }
  }

  actors {
    "/user/*" {
      report-by = group
    }
    "/system/*" {
      report-by = instance
      includes = ["tag:induction"]
    }
  }

  persistence.entities {
    // sharded:? will expand to /system/sharding/?/*
    "sharded:?" {
      report-by = group
    }
  }

  http {
    servers {
      "*:*" {
        paths {
          "*" {
            metrics = on
          }
        }
      }
    }
  }

  streams {
    "shopping.cart.*" {
      report-by = name
    }
  }

  dispatchers = {
    basic-information {
      names = ["*"]
    }
    time-information {
      names = ["*"]
    }
  }

  remote = {
    serialization-timing = on
    failure-detector-metrics = on
  }

  cluster = {
    domain-events = on
    member-events = on
    singleton-events = on
    shard-region-info = on
    node-status = on
    node-metrics = on
  }
}

cinnamon.jmx-importer {
  beans += {
    query = "java.lang:type=GarbageCollector,name=PS MarkSweep"
    attributes = [
      {
        attribute = "CollectionCount",
        metric-type = "GAUGE_LONG"
      },
      {
        attribute = "CollectionTime",
        metric-type = "GAUGE_LONG"
      }
    ]
  }
  beans += {
    query = "java.lang:type=GarbageCollector,name=PS Scavenge"
    attributes = [
      {
        attribute = "CollectionCount",
        metric-type = "GAUGE_LONG"
      }
    ]
  }
  beans += {
    query = "java.lang:type=OperatingSystem"
    attributes = [
      {
        attribute = "SystemCpuLoad",
        metric-type = "GAUGE_DOUBLE"
      },
      {
        attribute = "ProcessCpuLoad",
        metric-type = "GAUGE_DOUBLE"
      }
    ]
  }
}
